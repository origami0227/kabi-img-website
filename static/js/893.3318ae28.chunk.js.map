{"version":3,"file":"static/js/893.3318ae28.chunk.js","mappings":"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","sources":["components/Uploader.js","components/Tips.js","pages/Home.js"],"sourcesContent":["import React, {useRef} from 'react'\nimport {useStores} from \"../stores\";\nimport {observer, useLocalStore} from 'mobx-react'\nimport {message, Upload, Spin} from 'antd';\nimport {InboxOutlined} from '@ant-design/icons';\nimport styled from 'styled-components'\n\nconst {Dragger} = Upload;\n\nconst Result = styled.div`\n  margin-top: 30px;\n  border: 1px dashed #ccc;\n  padding: 20px;\n`\nconst H1 = styled.h1`\n  margin: 20px 0;\n  text-align: center;\n`\nconst Image = styled.img`\n  max-width: 300px;\n`\nconst Uploader = observer(() => {\n    const {ImageStore, UserStore} = useStores() //使用ImageStore\n    const ref1 = useRef() //标记设置宽度的input\n    const ref2 = useRef() //标记设置高度的input\n    const bindWidthChange = () => {\n        store.setWidth(ref1.current.value)\n    }\n    const bindHeightChange = () => {\n        store.setHeight(ref2.current.value)\n    }\n    //使用useLocalStore\n    const store = useLocalStore(() => ({\n        width: null, //用户输入的宽度\n        //设置宽度\n        setWidth() {\n            store.width = ref1.current.value\n        },\n        get widthStr() {\n            return store.width ? `/w/${store.width}` : '' //返回控制宽度字符串\n        },\n        height: null, // 用户输入的高度\n        //设置高度\n        setHeight() {\n            store.height = ref2.current.value\n        },\n        get heightSre() {\n            return store.height ? `/h/${store.height}` : '' //返回控制高度的字符串\n        },\n        get fullStr() {\n            //定制尺寸后的后的完整路径\n            return ImageStore.serverFile.attributes.url.attributes.url + '?imageView2/0' + store.widthStr + store.heightSre\n        }\n    }))\n    const props = {\n        showUploadList: false, //隐藏文件展示列表\n        beforeUpload: file => {\n            //里面有文件的情况（即已经上传）即可调用上传逻辑\n            ImageStore.setFile(file) //把上传的文件设置进去\n            ImageStore.setFilename(file.name)//设置文件名\n            //条件判断\n            if (UserStore.currentUser === null) {\n                message.warning('请先登录再上传')\n                return false //不执行后续的手动上传逻辑\n            }\n            //上传检测\n            window.file = file\n            //类型判断\n            if (!/(svg$)|(png$)|(jpg$)|(jpeg$)|(gif$)/ig.test(file.type)) {\n                //如果文件类型不是如上五种常见的图片类型,则进入如下逻辑\n                message.error('只能上传svg/png/jpg/jpeg/gif类型的图片')\n                return false //不手动上传\n            }\n            //大小判断\n            if (file.size > 1024 * 1024) {\n                //如果文件大小超过1mb，也不会上传\n                message.error('文件大小最多1mb')\n                return false\n            }\n            //上传\n            ImageStore.upload()\n                .then((serverFile) => {\n                    console.log('上传成功')\n                    console.log(serverFile)\n                }).catch((err) => {\n                console.log('上传失败')\n                console.log(err)\n            })\n            //取消自动上传\n            return false\n        }\n    }\n\n    return (\n        <Result>\n            <Spin tip=\"上传中\" spinning={ImageStore.isUpLoading}>\n            <h1>文件上传</h1>\n            <Dragger {...props}>\n                <p className=\"ant-upload-drag-icon\">\n                    <InboxOutlined/>\n                </p>\n                <p className=\"ant-upload-text\">点击或者拖拽上传图片</p>\n                <p className=\"ant-upload-hint\">\n                    仅支持.png/.gif/.jpg/.jpeg/.svg类型的图片，图片最大不超过1mb\n                </p>\n            </Dragger>\n            </Spin>\n            {ImageStore.serverFile ? <div>\n                <H1>上传结果:</H1>\n                <dl>\n                    <dt>线上地址</dt>\n                    <dd><a target=\"_blank\"\n                           rel=\"noreferrer\"\n                           href={ImageStore.serverFile.attributes.url.attributes.url}>{ImageStore.serverFile.attributes.url.attributes.url}</a>\n                    </dd>\n                    <dt>文件名</dt>\n                    <dd>{ImageStore.filename}</dd>\n                    <dt>图片预览</dt>\n                    <dd><Image src={ImageStore.serverFile.attributes.url.attributes.url} alt=\"\"/></dd>\n                    <dt>更多尺寸</dt>\n                    <dd>\n                        <input ref={ref1} onChange={bindWidthChange} placeholder=\"最大宽度（可选）\"/>\n                        <input ref={ref2} onChange={bindHeightChange} placeholder=\"最大高度（可选）\"/>\n                    </dd>\n                    <dd>\n                        <a rel=\"noreferrer\"\n                           target=\"_blank\" href={store.fullStr}>{store.fullStr}</a>\n                    </dd>\n                </dl>\n            </div> : null}\n        </Result>\n    )\n})\n\nexport default Uploader","import React from \"react\";\nimport {useStores} from '../stores'\nimport {observer} from 'mobx-react'\nimport styled from 'styled-components'\n\n\nconst Tip = styled.div`\n  background: orange;\n  padding: 10px;\n  margin: 30px 0;\n  color: #fff;\n  border-radius: 4px;\n`\nconst Tips = observer(({children}) => {\n    const {UserStore} = useStores()\n    return (\n        <>\n            {UserStore.currentUser ? null : <Tip>{children}</Tip>}\n        </>\n    )\n})\n\nexport default Tips","import React from \"react\";\nimport {observer} from 'mobx-react'\nimport Uploader from \"../components/Uploader\";\nimport Tips from \"../components/Tips\";\n\nconst Home = observer(() => {\n    return (\n        <>\n            <Tips>请先登录再上传!</Tips>\n            <Uploader/>\n        </>\n    )\n})\n\nexport default Home"],"names":["Dragger","Upload","Result","styled","H1","Image","observer","useStores","ImageStore","UserStore","ref1","useRef","ref2","store","useLocalStore","width","setWidth","current","value","widthStr","height","setHeight","heightSre","fullStr","serverFile","attributes","url","props","showUploadList","beforeUpload","file","setFile","setFilename","name","currentUser","message","window","test","type","size","upload","then","console","log","catch","err","tip","spinning","isUpLoading","className","InboxOutlined","target","rel","href","filename","src","alt","ref","onChange","placeholder","Tip","children"],"sourceRoot":""}